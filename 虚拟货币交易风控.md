## 虚拟货币交易风控

### 概述
现在很多虚拟货币交易平台支持保证金交易（Margin），也就是说提供了做空机制，在放大收益的同时也放大了风险，因此为了对交易过程进行有效的风险控制，必须了解其机制，防止被强制平仓风险。

### 概念和符号定义
1. 杠杆倍数$\alpha$：借款资产除以自有资产的比例。
这里的资产可以是法币现金，也可以是虚拟货币资产。
2. 初始负债率$\beta$：借款资产占初始总资产（含负债）的比例。
可以得出：$\beta=\frac{\alpha}{1+\alpha}$，注意和实时负债率不同。
3. 当前价格$P$：虚拟货币的当前实时价格（随机变量）。
无特殊说明时表示以法币计价。
4. 交易价格$P_n$：某次交易的固定价格。
比如以$P_1$价格做空。
5. 溢价率$\lambda$： 当前价格除以之前某次交易价格，即$\lambda=\frac{P}{P_1}$。
6. 预留比例$\rho$：保证金交易时，当前净资产和总资产的比值。
也就是说实时负债率需要小于1-$\rho$,在bitfinex平台中$\rho$=15%。

### 现金做多
设有现金资产1，借款$\alpha$，以$P_1$价格做多（兑换成$\frac{1+\alpha}{P_1}$数量的虚拟币），实时市值为：$\frac{1+\alpha}{P_1}P$。
受预留比例$\rho$的限制，实时负债率需要小于$1-\rho$，即：
$$\frac{\alpha}{\frac{1+\alpha}{P_1}P} \leq 1-\rho$$ 整理后得：$$\beta/\lambda \leq 1-\rho$$ 则当前溢价率：
$$\lambda \geq \beta / (1-\rho)$$
和现金做多类似，持币做多的公式完全相同。

### 现金做空
设有现金资产1，借价值为$\alpha$的币卖出，市值为$1+\alpha$，负债为$\frac{\alpha}{P_1}P$，根据约束有：
$$\frac{\frac{\alpha}{P_1}P}{1+\alpha} \leq 1-\rho$$ 整理后得：
$$\beta\lambda \leq 1-\rho$$ 则当前溢价率：
$$\lambda \leq (1-\rho) / \beta$$
和现金做空类似，持币做空的公式完全相同。

### 仓位控制
根据上面的公式，以bitfinex平台来说，做多/空时，强制平仓线如下：

杠杆倍数$\alpha$|负债率$\beta$|做多平仓线|做空平仓线
--|--|--|--
0|0|-100%|$\infty$
0.5|0.3333|**-60.78%**|155%
1|0.5|-41.18%|**70%**
2|0.6667|-21.57%|27.5%
2.3333|0.7|-17.65%|21.43%

由上表可以看出，做多比做空对于对价格变化率更敏感，比如：1倍做多时，跌幅41.18%时即触发平仓，而1倍做多则需要涨70%才平仓。
安全起见，做多时，杠杆控制在0.5以内（跌幅60%平仓），做空做多1倍做空（涨幅70%平仓）。

<!--stackedit_data:
eyJoaXN0b3J5IjpbMTgyMzgzMjkyNF19
-->